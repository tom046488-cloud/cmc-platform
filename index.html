
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<title>CMC Fan Platform</title>
<!-- Icons & Fonts -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
<!-- Cloudinary Widget -->
<script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
<style>
/* ========== ALL EXISTING CSS ‚Äì UNCHANGED ========== */
.notification-wrapper { position: relative; margin-right: 15px; }
#bellIcon { font-size: 1.4rem; cursor: pointer; position: relative; color: var(--text); transition: color 0.3s; }
#bellIcon.has-notifications { color: var(--accent); animation: bellRing 1s ease-in-out infinite; }
@keyframes bellRing {
0%, 100% { transform: rotate(0deg); }
10%, 30%, 50%, 70%, 90% { transform: rotate(-15deg); }
20%, 40%, 60%, 80% { transform: rotate(15deg); }
}
.notification-badge { position: absolute; top: -8px; right: -8px; background: var(--danger); color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 0.7rem; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid var(--card); z-index: 1; }
.notification-dropdown { position: absolute; top: 45px; right: 0; width: 350px; max-width: 90vw; background: var(--card); border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); z-index: 2000; display: none; max-height: 500px; overflow: hidden; }
.notification-dropdown.active { display: flex; flex-direction: column; animation: slideDown 0.3s ease; }
@keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
.notification-header { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; }
.notification-header h3 { margin: 0; font-size: 1.1rem; }
.notification-list { flex: 1; overflow-y: auto; max-height: 400px; }
.notification-item { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; transition: background 0.2s; display: flex; align-items: flex-start; gap: 12px; }
.notification-item:hover { background: rgba(255,255,255,0.03); }
.notification-item.unread { background: rgba(67, 97, 238, 0.1); border-left: 3px solid var(--primary); }
.notification-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; flex-shrink: 0; }
.notification-content { flex: 1; min-width: 0; }
.notification-title { font-weight: 600; font-size: 0.95rem; margin-bottom: 5px; color: var(--text); }
.notification-message { font-size: 0.85rem; color: var(--text-gray); line-height: 1.4; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
.notification-time { font-size: 0.75rem; color: #666; margin-top: 5px; }
.notification-actions { display: flex; gap: 8px; padding: 10px 15px; border-top: 1px solid rgba(255,255,255,0.1); }
.notification-actions button { flex: 1; padding: 8px; border: none; border-radius: 6px; background: rgba(255,255,255,0.05); color: var(--text); cursor: pointer; font-size: 0.8rem; }
.notification-actions button:hover { background: rgba(255,255,255,0.1); }
.notification-empty { padding: 40px 20px; text-align: center; color: var(--text-gray); }
.notification-empty i { font-size: 3rem; margin-bottom: 15px; opacity: 0.3; }
.notification-type { display: inline-block; padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: 600; margin-right: 5px; }
.type-message { background: rgba(52, 152, 219, 0.2); color: #3498db; }
.type-gift { background: rgba(241, 196, 15, 0.2); color: #f1c40f; }
.type-system { background: rgba(46, 204, 113, 0.2); color: #2ecc71; }
.incoming-alert {
position: fixed;
top: 20px;
left: 50%;
transform: translateX(-50%);
width: 90%;
max-width: 400px;
background: rgba(26, 26, 31, 0.95);
backdrop-filter: blur(10px);
border: 1px solid var(--primary);
border-radius: 12px;
padding: 15px;
display: flex;
align-items: center;
gap: 15px;
z-index: 9999;
box-shadow: 0 10px 40px rgba(0,0,0,0.5);
animation: slideInDown 0.5s ease;
}
@keyframes slideInDown { from { top: -100px; opacity: 0; } to { top: 20px; opacity: 1; } }
:root {
--primary: #8e44ad;
--primary-dark: #6c3483;
--accent: #00d2ff;
--bg: #0f0f12;
--card: #1a1a1f;
--text: #ffffff;
--text-gray: #a0a0b0;
--success: #2ecc71;
--danger: #e74c3c;
--vip-gold: #f1c40f;
--support-blue: #3498db;
}
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body { margin: 0; padding: 0; font-family: 'Inter', sans-serif; background-color: var(--bg); color: var(--text); overflow-x: hidden; padding-bottom: 80px; }
body::before {
content: "";
position: fixed;
top: 0; left: 0; width: 200%; height: 200%;
background: radial-gradient(circle, rgba(142,68,173,0.15) 0%, rgba(0,0,0,0) 70%);
background-size: 50% 50%;
animation: moveBackground 20s linear infinite;
z-index: -1;
pointer-events: none;
}
@keyframes moveBackground {
0% { transform: translate(0, 0); }
50% { transform: translate(-10%, -10%); }
100% { transform: translate(0, 0); }
}
.header {
background: rgba(26, 26, 31, 0.95);
backdrop-filter: blur(10px);
padding: 15px;
position: sticky;
top: 0;
z-index: 100;
display: flex;
justify-content: space-between;
align-items: center;
border-bottom: 1px solid rgba(255,255,255,0.05);
}
.logo-area { display: flex; align-items: center; gap: 10px; font-weight: 800; font-size: 1.1rem; }
.logo-img { width: 35px; height: 35px; border-radius: 50%; border: 2px solid var(--primary); }
/* Sidebar menu */
.menu-toggle { font-size: 1.5rem; cursor: pointer; color: var(--text); }
.sidebar {
position: fixed; top: 0; left: -280px; width: 280px; height: 100%; background: var(--card);
z-index: 2000; transition: left 0.3s; padding: 20px; overflow-y: auto;
border-right: 1px solid rgba(255,255,255,0.1);
}
.sidebar.open { left: 0; }
.sidebar .close { position: absolute; top: 10px; right: 10px; font-size: 1.5rem; cursor: pointer; }
.sidebar .menu-item { display: flex; align-items: center; gap: 15px; padding: 15px; border-radius: 10px; cursor: pointer; margin-bottom: 5px; }
.sidebar .menu-item:hover { background: rgba(255,255,255,0.05); }
.sidebar .menu-item.active { background: var(--primary); }
.overlay {
position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5);
z-index: 1500; display: none;
}
.overlay.active { display: block; }
.Bottom-nav {
position: fixed;
bottom: 0; width: 100%;
background: var(--card);
display: flex;
justify-content: space-around;
padding: 10px 0;
border-top: 1px solid rgba(255,255,255,0.05);
z-index: 1000;
}
.nav-item { color: var(--text-gray); text-align: center; font-size: 0.7rem; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;}
.nav-item.active { color: var(--primary); transform: translateY(-2px); }
.nav-item i { font-size: 1.2rem; }
.page { display: none; padding: 15px; animation: fadeIn 0.4s ease; }
.page.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.card { background: var(--card); border-radius: 16px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.05); }
.wallet-card { background: linear-gradient(135deg, var(--primary), #3a1c71); text-align: center; padding: 30px 20px; position: relative; overflow: hidden; }
.balance-label { opacity: 0.8; font-size: 0.9rem; }
.balance-amount { font-size: 2.5rem; font-weight: 800; margin: 10px 0; }
.vip-badge { background: rgba(0,0,0,0.3); padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; display: inline-block; border: 1px solid rgba(255,255,255,0.2); }
.market-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
.product-card { background: #25252b; border-radius: 12px; overflow: hidden; border: 1px solid #333; }
.product-img { width: 100%; height: 100px; object-fit: cover; background: #333; display: flex; align-items: center; justify-content: center; color: #666; font-size: 2rem; }
.product-info { padding: 10px; }
.product-title { font-size: 0.9rem; font-weight: 600; margin-bottom: 5px; }
.product-price { color: var(--success); font-weight: 800; }
.btn-buy { width: 100%; background: var(--primary); color: white; border: none; padding: 8px; border-radius: 6px; margin-top: 8px; cursor: pointer; }
.celeb-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 15px; }
.celeb-card { background: #25252b; border-radius: 12px; padding: 10px; text-align: center; cursor: pointer; transition: 0.2s; position: relative; }
.celeb-img { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid var(--primary); margin-bottom: 8px; }
.celeb-name { font-size: 0.8rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.verified-badge { color: var(--accent); font-size: 0.8rem; margin-left: 4px; }
.chat-window { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 2000; display: none; flex-direction: column; }
.chat-header { padding: 15px; background: var(--card); display: flex; align-items: center; gap: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }
.chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; background-image: url('https://www.transparenttextures.com/patterns/stardust.png'); }
.message { max-width: 80%; padding: 10px 15px; border-radius: 18px; font-size: 0.95rem; line-height: 1.4; position: relative; word-wrap: break-word; }
.message.sent { align-self: flex-end; background: var(--primary); color: white; border-bottom-right-radius: 4px; }
.message.received { align-self: flex-start; background: #2a2a30; color: white; border-bottom-left-radius: 4px; }
.message-time { font-size: 0.65rem; opacity: 0.8; display: block; margin-top: 5px; color: rgba(255,255,255,0.7); }
.chat-input-area { padding: 15px; background: var(--card); display: flex; gap: 10px; align-items: center; padding-bottom: 20px; }
.chat-input { flex: 1; background: #121215; border: none; padding: 12px; border-radius: 25px; color: white; outline: none; }
.send-btn { background: var(--primary); color: white; width: 40px; height: 40px; border-radius: 50%; border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; }
.gift-btn { background: linear-gradient(135deg, #f1c40f, #e67e22); color: white; width: 40px; height: 40px; border-radius: 50%; border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; }
.action-btn { width: 100%; padding: 15px; margin: 10px 0; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1rem; }
.btn-deposit { background: var(--success); color: white; }
.btn-withdraw { background: var(--danger); color: white; }
.btn-primary { background: var(--primary); color: white; }
.input-box { width: 100%; padding: 12px; background: #0f0f12; border: 1px solid #333; border-radius: 8px; color: white; outline: none; margin-bottom: 10px; }
.modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 3000; display: none; align-items: center; justify-content: center; padding: 20px; overflow-y: auto;}
.modal-content { background: var(--card); width: 100%; max-width: 400px; padding: 25px; border-radius: 20px; position: relative; border: 1px solid var(--primary); }
.close-modal { position: absolute; right: 20px; top: 15px; font-size: 1.5rem; cursor: pointer; color: #888; }
.red-popup { background: linear-gradient(135deg, #c0392b, #8e44ad); border: 2px solid white; text-align: center; }
.spinner-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0f0f12; z-index: 6000; display: none; flex-direction: column; align-items: center; justify-content: center; }
.spinner { width: 60px; height: 60px; border: 5px solid rgba(142,68,173,0.3); border-top: 5px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 25px; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
.status-text { color: var(--primary); font-size: 1.1rem; letter-spacing: 1px; font-weight: 600; text-align: center; }
.gift-card-option { display: flex; align-items: center; gap: 10px; padding: 10px; background: #25252b; margin-bottom: 8px; border-radius: 8px; border: 1px solid #333; }
.gift-card-option i { font-size: 1.5rem; color: var(--text-gray); }
.gift-grid-container { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; }
.gift-item { background: #25252b; padding: 10px; border-radius: 12px; text-align: center; border: 1px solid #333; cursor: pointer; transition: 0.2s; }
.gift-item:hover { border-color: var(--vip-gold); background: #333; transform: translateY(-3px); }
.gift-emoji { font-size: 2rem; display: block; margin-bottom: 5px; }
.gift-price-tag { color: var(--success); font-weight: 800; font-size: 0.8rem; }
.support-float {
position: fixed;
bottom: 80px;
right: 20px;
width: 60px;
height: 60px;
background: var(--support-blue);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 4px 15px rgba(0,0,0,0.5);
z-index: 2500;
cursor: pointer;
animation: bounce 2s infinite;
}
@keyframes bounce {
0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
40% {transform: translateY(-10px);}
60% {transform: translateY(-5px);}
}
.support-float i { color: white; font-size: 1.5rem; }
@media (max-width: 768px) {
.notification-dropdown { width: 95vw; right: -10px; }
}
/* Recent chats page timestamps */
.recent-time { font-size: 0.75rem; color: var(--text-gray); }
/* Green redeem modal */
.green-popup {
background: linear-gradient(135deg, #1e7e34, #2ecc71);
border: 2px solid #a3e4d7;
text-align: center;
color: white;
}
.green-popup h3, .green-popup p, .green-popup label { color: white; }
.green-popup select, .green-popup input { background: rgba(255,255,255,0.9); color: #000; border: none; }
.btn-redeem { background: #f39c12; color: white; font-weight: bold; border: none; }
.gift-card-select { width: 100%; padding: 12px; border-radius: 8px; margin-bottom: 10px; background: rgba(255,255,255,0.95); color: #000; font-size: 0.95rem; }
/* Withdrawal modal */
.withdraw-modal-content { background: var(--card); border: 2px solid var(--success); }
/* Invisible exit button */
.invisible-exit {
position: absolute;
top: 10px;
right: 15px;
font-size: 1.8rem;
color: rgba(255,255,255,0.6);
cursor: pointer;
transition: color 0.2s;
z-index: 10;
}
.invisible-exit:hover { color: white; }
/* Floating Gift Card Store button */
.gift-card-float {
position: fixed;
bottom: 150px;
right: 20px;
width: 65px;
height: 65px;
background: linear-gradient(145deg, #ff9a44, #ff6b6b);
border-radius: 50%;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
box-shadow: 0 8px 20px rgba(255,107,107,0.6);
z-index: 2600;
cursor: pointer;
animation: pulse 2s infinite, floatGlow 3s infinite alternate;
border: 2px solid rgba(255,255,255,0.3);
}
@keyframes pulse {
0% { transform: scale(1); }
50% { transform: scale(1.08); }
100% { transform: scale(1); }
}
@keyframes floatGlow {
from { box-shadow: 0 8px 20px rgba(255,107,107,0.6); }
to { box-shadow: 0 12px 30px rgba(255,154,68,0.9); }
}
.gift-card-float i {
color: white;
font-size: 1.8rem;
text-shadow: 0 2px 5px rgba(0,0,0,0.3);
}
.gift-card-float span {
color: white;
font-size: 0.55rem;
font-weight: 800;
text-transform: uppercase;
letter-spacing: 1px;
background: rgba(0,0,0,0.3);
padding: 2px 6px;
border-radius: 20px;
margin-top: -2px;
}
/* Gift Store Modal */
.gift-store-modal {
background: linear-gradient(145deg, #1e1e24, #2a2a35);
border: 2px solid #f1c40f;
max-width: 700px !important;
width: 95%;
color: white;
}
.gift-store-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
gap: 15px;
margin: 20px 0;
max-height: 350px;
overflow-y: auto;
padding-right: 5px;
}
.gift-store-item {
background: rgba(0,0,0,0.3);
border: 1px solid #444;
border-radius: 16px;
padding: 15px 8px;
text-align: center;
cursor: pointer;
transition: 0.2s;
backdrop-filter: blur(5px);
}
.gift-store-item.selected {
border: 2px solid #f1c40f;
background: rgba(241,196,15,0.15);
box-shadow: 0 0 15px rgba(241,196,15,0.5);
}
.gift-store-item i {
font-size: 2.4rem;
color: #f1c40f;
margin-bottom: 8px;
display: block;
}
.gift-store-item span {
font-size: 0.85rem;
font-weight: 600;
color: white;
}
.amount-section {
background: rgba(0,0,0,0.5);
padding: 20px;
border-radius: 16px;
margin: 15px 0;
}
.gift-store-input {
width: 100%;
padding: 14px;
background: #0a0a0e;
border: 1px solid #f1c40f;
border-radius: 12px;
color: white;
font-size: 1.1rem;
margin-top: 8px;
}
.gift-store-btn {
background: linear-gradient(145deg, #f1c40f, #e67e22);
border: none;
padding: 16px;
border-radius: 40px;
font-weight: 800;
font-size: 1.2rem;
color: black;
width: 100%;
cursor: pointer;
transition: 0.2s;
margin-top: 10px;
}
.gift-store-btn:disabled {
opacity: 0.5;
cursor: not-allowed;
}
.processing-box {
background: #00000080;
border-radius: 16px;
padding: 20px;
margin: 15px 0;
text-align: center;
border: 1px dashed #f1c40f;
}
.timer-big {
font-size: 2rem;
font-weight: 800;
color: #f1c40f;
}
.history-list {
max-height: 200px;
overflow-y: auto;
background: #0a0a0e;
border-radius: 16px;
padding: 10px;
margin-top: 15px;
}
.history-item {
background: #1e1e24;
border-left: 4px solid #f1c40f;
padding: 12px;
margin-bottom: 8px;
border-radius: 8px;
font-size: 0.8rem;
}
/* Airdrop button */
.airdrop-btn {
background: var(--success);
color: white;
border: none;
padding: 8px 20px;
border-radius: 30px;
font-weight: 600;
cursor: pointer;
transition: 0.2s;
font-size: 0.9rem;
}
.airdrop-btn:disabled {
background: #555;
cursor: not-allowed;
opacity: 0.7;
}
.airdrop-timer {
color: var(--vip-gold);
font-weight: 600;
}
/* ========== MUSIC ICON IN HEADER ========== */
.music-icon {
font-size: 1.4rem;
cursor: pointer;
color: var(--text-gray);
margin-left: 10px;
transition: color 0.3s;
}
.music-icon.playing {
color: var(--vip-gold);
}
/* ========== VIP CALL ICONS IN CHAT ========== */
.vip-call-icons {
display: flex;
gap: 15px;
margin-left: 15px;
}
.vip-call-icons i {
font-size: 1.4rem;
color: var(--vip-gold);
cursor: pointer;
transition: transform 0.2s, color 0.2s;
}
.vip-call-icons i:hover {
transform: scale(1.2);
color: var(--accent);
}
/* ========== RAINBOW DUST CALL OVERLAY ========== */
.call-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
z-index: 10000;
display: none;
flex-direction: column;
align-items: center;
justify-content: center;
background: radial-gradient(circle at 30% 30%, #ff00cc, #3333ff, #00ff99, #ffcc00);
background-size: 300% 300%;
animation: rainbowMove 8s ease infinite;
overflow: hidden;
}
@keyframes rainbowMove {
0% { background-position: 0% 0%; }
50% { background-position: 100% 100%; }
100% { background-position: 0% 0%; }
}
.dust-particles {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
pointer-events: none;
}
.dust-particle {
position: absolute;
width: 4px;
height: 4px;
background: rgba(255,255,255,0.6);
border-radius: 50%;
box-shadow: 0 0 10px white;
animation: floatDust 12s infinite linear;
}
@keyframes floatDust {
0% { transform: translateY(100vh) translateX(0); opacity: 0; }
10% { opacity: 1; }
90% { opacity: 1; }
100% { transform: translateY(-20vh) translateX(50px); opacity: 0; }
}
.call-celebrity-photo {
width: 120px;
height: 120px;
border-radius: 50%;
border: 5px solid white;
box-shadow: 0 0 50px rgba(255,255,255,0.8);
object-fit: cover;
z-index: 10;
animation: pulsePhoto 2s infinite;
}
@keyframes pulsePhoto {
0% { transform: scale(1); box-shadow: 0 0 50px rgba(255,255,255,0.8); }
50% { transform: scale(1.1); box-shadow: 0 0 80px rgba(255,255,255,1); }
100% { transform: scale(1); box-shadow: 0 0 50px rgba(255,255,255,0.8); }
}
.call-status {
margin-top: 30px;
font-size: 1.8rem;
font-weight: 700;
color: white;
text-shadow: 0 0 20px black;
z-index: 10;
}
.call-timer {
margin-top: 15px;
font-size: 1.2rem;
color: rgba(255,255,255,0.9);
z-index: 10;
}
/* ========== NEW: GIVEAWAY BOX ========== */
.giveaway-box {
position: fixed;
bottom: 100px;
left: 50%;
transform: translateX(-50%);
background: linear-gradient(45deg, #ff6b6b, #f06595, #cc5de8, #5c7cfa);
background-size: 300% 300%;
animation: rainbowMove 10s ease infinite;
border-radius: 40px;
padding: 25px;
text-align: center;
z-index: 10000;
box-shadow: 0 10px 30px rgba(0,0,0,0.5);
border: 2px solid white;
display: none;
width: 90%;
max-width: 350px;
}
.giveaway-box h3 { color: white; margin-bottom: 10px; }
.giveaway-countdown {
font-size: 2.5rem;
font-weight: 800;
color: white;
text-shadow: 0 0 10px black;
margin: 10px 0;
}
.giveaway-remaining {
font-size: 1.2rem;
color: white;
margin-bottom: 15px;
}
.giveaway-input {
width: 100%;
padding: 12px;
border-radius: 30px;
border: none;
margin-bottom: 10px;
text-align: center;
}
.giveaway-claim-btn {
background: white;
color: #8e44ad;
border: none;
padding: 12px 30px;
border-radius: 40px;
font-weight: 700;
cursor: pointer;
width: 100%;
font-size: 1.1rem;
}
.giveaway-claim-btn:disabled {
opacity: 0.5;
cursor: not-allowed;
}
/* ========== GLOBAL MUSIC PLAYER (bottom right) ========== */
.global-music-player {
position: fixed;
bottom: 80px;
left: 20px;
background: rgba(26,26,31,0.9);
backdrop-filter: blur(10px);
border-radius: 60px;
padding: 12px 20px;
display: flex;
align-items: center;
gap: 15px;
border: 1px solid rgba(255,255,255,0.1);
z-index: 2000;
display: none;
}
.global-music-player.active { display: flex; }
.global-music-player i { font-size: 1.5rem; cursor: pointer; }
.volume-slider { width: 80px; }
/* Profile picture upload */
.profile-pic-edit {
position: relative;
display: inline-block;
}
.profile-pic-edit img {
width: 100px;
height: 100px;
border-radius: 50%;
border: 4px solid var(--card);
cursor: pointer;
}
.profile-pic-edit i {
position: absolute;
bottom: 5px;
right: 5px;
background: var(--primary);
border-radius: 50%;
padding: 8px;
font-size: 0.9rem;
cursor: pointer;
}
/* New styles for posts, groups, etc. */
.post { background: var(--card); border-radius: 16px; margin-bottom: 20px; overflow: hidden; }
.post-header { display: flex; align-items: center; padding: 15px; gap: 10px; }
.post-avatar { width: 40px; height: 40px; border-radius: 50%; }
.post-user { font-weight: 600; }
.post-time { font-size: 0.7rem; color: var(--text-gray); }
.post-content { padding: 0 15px 15px; }
.post-media img, .post-media video { width: 100%; max-height: 400px; object-fit: cover; }
.post-actions { display: flex; padding: 10px 15px; border-top: 1px solid rgba(255,255,255,0.05); gap: 20px; }
.post-action { color: var(--text-gray); cursor: pointer; }
.post-action:hover { color: var(--primary); }
.friend-item { display: flex; align-items: center; gap: 15px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 12px; margin-bottom: 10px; }
.friend-avatar { width: 50px; height: 50px; border-radius: 50%; }
.group-card { display: flex; align-items: center; gap: 15px; background: rgba(255,255,255,0.05); border-radius: 12px; padding: 15px; margin-bottom: 10px; }
.group-avatar { width: 50px; height: 50px; border-radius: 50%; }
.battle-container { display: flex; gap: 20px; margin-top: 20px; }
.battle-user { flex: 1; text-align: center; background: rgba(255,255,255,0.05); border-radius: 16px; padding: 20px; }
.battle-score { font-size: 2rem; font-weight: 800; color: var(--accent); margin: 10px 0; }
.battle-timer { font-size: 1.2rem; color: var(--vip-gold); }
.transaction-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); }
</style>
</head>
<body>
<!-- ========== AUDIO FILES ========== -->
<audio id="sendSound" preload="auto">
<source src="https://close-plum-wlt1tch4ep.edgeone.app/floraphonic-happy-pop-1-185286.mp3" type="audio/mpeg">
</audio>
<audio id="notificationSound" preload="auto">
<source src="https://obliged-beige-gdsrsmjvj7.edgeone.app/universfield-new-notification-032-480570.mp3" type="audio/mpeg">
</audio>
<audio id="errorSound" preload="auto">
<source src="https://pleased-maroon-xnqs8ftowb.edgeone.app/u_31vnwfmzt6-error-126627.mp3" type="audio/mpeg">
</audio>
<audio id="bgMusic" preload="auto" loop="false">
<source src="https://arrogant-aquamarine-f5wub9nau7.edgeone.app/The_stranglers_-_Golden_brown_looped_slowed_to_perfection_._(SkySound.cc).mp3" type="audio/mpeg">
</audio>
<!-- Global music player audio (controlled by admin) -->
<audio id="globalAudio" preload="auto" style="display:none;"></audio>
<!-- FLOATING GIFT CARD BUTTON -->
<div class="gift-card-float" onclick="openGiftStore()">
<i class="fas fa-gift"></i>
<span>GIFT CARDS</span>
</div>
<!-- FLOATING SUPPORT BUTTON -->
<div class="support-float" onclick="openSupportChat()">
<i class="fas fa-headset"></i>
</div>
<!-- ========== GIVEAWAY BOX ========== -->
<div id="giveawayBox" class="giveaway-box">
<span class="invisible-exit" onclick="document.getElementById('giveawayBox').style.display='none'">&times;</span>
<i class="fas fa-gift" style="font-size: 3rem; color: white; margin-bottom: 10px;"></i>
<h3 id="giveawayCelebName"></h3>
<div id="giveawayCountdown" class="giveaway-countdown">00</div>
<div id="giveawayRemaining" class="giveaway-remaining"></div>
<input type="number" id="claimAmount" class="giveaway-input" placeholder="Amount ($)" min="0.01" step="0.01">
<button id="claimBtn" class="giveaway-claim-btn" onclick="claimGiveaway()">Claim</button>
</div>
<!-- ========== GLOBAL MUSIC PLAYER UI ========== -->
<div id="globalMusicPlayer" class="global-music-player">
<i class="fas fa-play" id="globalPlayPause" onclick="toggleGlobalMusic()"></i>
<input type="range" class="volume-slider" id="globalVolumeSlider" min="0" max="1" step="0.1" value="0.7" onchange="setLocalVolume(this.value)">
<i class="fas fa-volume-up"></i>
</div>
<!-- AUTH SCREEN -->
<div id="authScreen" class="modal active" style="display: flex; background: var(--bg);">
<div class="modal-content" style="border: none; background: transparent; box-shadow: none;">
<div style="text-align: center; margin-bottom: 30px;">
<img src="https://i.ibb.co/gZqjS62p/Gemini-Generated-Image-lh3nyulh3nyulh3n.png" style="width: 90px; height: 90px; border-radius: 50%; box-shadow: 0 0 30px rgba(142,68,173,0.5);">
<h2 style="margin-top: 20px;">CMC Fan Platform</h2>
<p style="color: var(--text-gray);">Connect with your favorite creators</p>
</div>
<div id="loginForm">
<input type="email" id="loginEmail" class="input-box" placeholder="Email Address">
<input type="password" id="loginPassword" class="input-box" placeholder="Password">
<button class="action-btn btn-primary" onclick="handleLogin()">Log In</button>
<p style="text-align: center; margin-top: 20px; color: var(--text-gray);">
No account? <span onclick="toggleAuth('register')" style="color: var(--accent); cursor: pointer;">Sign Up</span>
</p>
</div>
<div id="registerForm" style="display: none;">
<input type="text" id="regName" class="input-box" placeholder="Full Name">
<input type="email" id="regEmail" class="input-box" placeholder="Email Address">
<input type="password" id="regPassword" class="input-box" placeholder="Password">
<button class="action-btn btn-primary" onclick="handleSignup()">Create Account</button>
<p style="text-align: center; margin-top: 20px; color: var(--text-gray);">
Has account? <span onclick="toggleAuth('login')" style="color: var(--accent); cursor: pointer;">Log In</span>
</p>
</div>
</div>
</div>
<!-- SPINNER -->
<div id="registrationSpinner" class="spinner-overlay">
<div class="spinner"></div>
<div id="spinnerText" class="status-text">Initializing...</div>
</div>
<!-- SIDEBAR MENU -->
<div class="sidebar" id="sidebar">
<span class="close" onclick="toggleSidebar()">&times;</span>
<div class="menu-item active" data-page="home" onclick="switchPage('home'); toggleSidebar();"><i class="fas fa-home"></i> Home</div>
<div class="menu-item" data-page="explore" onclick="switchPage('explore'); toggleSidebar();"><i class="fas fa-compass"></i> Explore</div>
<div class="menu-item" data-page="messages" onclick="switchPage('messages'); toggleSidebar();"><i class="fas fa-comment-dots"></i> Messages</div>
<div class="menu-item" data-page="friends" onclick="switchPage('friends'); toggleSidebar();"><i class="fas fa-user-friends"></i> Friends</div>
<div class="menu-item" data-page="groups" onclick="switchPage('groups'); toggleSidebar();"><i class="fas fa-users"></i> Groups</div>
<div class="menu-item" data-page="battles" onclick="switchPage('battles'); toggleSidebar();"><i class="fas fa-fist-raised"></i> Battles</div>
<div class="menu-item" data-page="wallet" onclick="switchPage('wallet'); toggleSidebar();"><i class="fas fa-wallet"></i> Wallet</div>
<div class="menu-item" data-page="notifications" onclick="switchPage('notifications'); toggleSidebar();"><i class="fas fa-bell"></i> Notifications</div>
<div class="menu-item" data-page="profile" onclick="switchPage('profile'); toggleSidebar();"><i class="fas fa-user"></i> Profile</div>
<div class="menu-item" data-page="settings" onclick="switchPage('settings'); toggleSidebar();"><i class="fas fa-cog"></i> Settings</div>
<div class="menu-item" data-page="support" onclick="switchPage('support'); toggleSidebar();"><i class="fas fa-headset"></i> Customer Support</div>
<div class="menu-item" data-page="celebs" onclick="switchPage('celebs'); toggleSidebar();"><i class="fas fa-star"></i> Celebrities</div>
<div class="menu-item" data-page="market" onclick="switchPage('market'); toggleSidebar();"><i class="fas fa-store"></i> Shop</div>
<div class="menu-item" data-page="recentChats" onclick="switchPage('recentChats'); toggleSidebar();"><i class="fas fa-history"></i> Recent Chats</div>
<div class="menu-item" data-page="social" onclick="switchPage('social'); toggleSidebar();"><i class="fas fa-users"></i> Community</div>
</div>
<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>
<!-- MAIN APP -->
<div id="mainApp" style="display: none;">
<div class="header">
<i class="fas fa-bars menu-toggle" onclick="toggleSidebar()"></i>
<div class="logo-area">
<img src="https://i.ibb.co/gZqjS62p/Gemini-Generated-Image-lh3nyulh3nyulh3n.png" class="logo-img">
<span>CMC Fan Platform</span>
</div>
<div style="display: flex; align-items: center;">
<!-- MUSIC ICON (local background music toggle) -->
<i class="fas fa-music music-icon" onclick="toggleBackgroundMusic()"></i>
<div class="notification-wrapper">
<i class="fas fa-bell" id="bellIcon" onclick="toggleNotifications()"></i>
<span id="notificationBadge" class="notification-badge" style="display: none;">0</span>
<div id="notificationDropdown" class="notification-dropdown">
<div class="notification-header">
<h3>Notifications</h3>
<span style="font-size: 0.8rem; color: var(--text-gray);" id="notificationCount">0 new</span>
</div>
<div id="notificationList" class="notification-list">
<div class="notification-empty">
<i class="fas fa-bell-slash"></i>
<p>No notifications yet</p>
</div>
</div>
<div class="notification-actions">
<button onclick="markAllAsRead()">Mark All Read</button>
<button onclick="clearAllNotifications()">Clear All</button>
</div>
</div>
<span id="headerBal" style="margin-left:8px; font-size:0.9rem; color:var(--success); font-weight:bold;"></span>
</div>
</div>
</div>
<!-- BOTTOM NAVIGATION (shortcut to main pages) -->
<div class="bottom-nav">
<div class="nav-item active" data-page="home" onclick="switchPage('home')"><i class="fas fa-home"></i><span>Home</span></div>
<div class="nav-item" data-page="explore" onclick="switchPage('explore')"><i class="fas fa-compass"></i><span>Explore</span></div>
<div class="nav-item" data-page="messages" onclick="switchPage('messages')"><i class="fas fa-comment-dots"></i><span>Messages</span></div>
<div class="nav-item" data-page="friends" onclick="switchPage('friends')"><i class="fas fa-user-friends"></i><span>Friends</span></div>
<div class="nav-item" data-page="groups" onclick="switchPage('groups')"><i class="fas fa-users"></i><span>Groups</span></div>
<div class="nav-item" data-page="battles" onclick="switchPage('battles')"><i class="fas fa-fist-raised"></i><span>Battles</span></div>
<div class="nav-item" data-page="wallet" onclick="switchPage('wallet')"><i class="fas fa-wallet"></i><span>Wallet</span></div>
<div class="nav-item" data-page="profile" onclick="switchPage('profile')"><i class="fas fa-user"></i><span>Profile</span></div>
</div>
<!-- MAIN CONTENT PAGES -->
<div class="main-content">
<!-- HOME PAGE (feed) -->
<div id="home" class="page active">
<div class="card">
<div style="display:flex; gap:10px;">
<img src="" id="homeAvatar" style="width:50px; height:50px; border-radius:50%;">
<input type="text" id="postInput" class="input-box" placeholder="What's on your mind?" style="margin-bottom:0;">
</div>
<div style="display:flex; gap:10px; margin-top:10px;">
<button class="btn" style="flex:1; padding:10px;" onclick="openMediaUpload('image')"><i class="fas fa-image"></i> Photo</button>
<button class="btn" style="flex:1; padding:10px;" onclick="openMediaUpload('video')"><i class="fas fa-video"></i> Reel</button>
</div>
</div>
<div id="feed"></div>
</div>
<!-- EXPLORE PAGE -->
<div id="explore" class="page">
<input type="text" class="input-box" placeholder="Search users..." onkeyup="searchUsers(this.value)">
<div id="exploreFeed"></div>
</div>
<!-- MESSAGES PAGE -->
<div id="messages" class="page">
<div style="display:flex; gap:10px; margin-bottom:15px;">
<button class="btn" style="flex:1;" onclick="showChats('private')">Private</button>
<button class="btn" style="flex:1;" onclick="showChats('groups')">Groups</button>
</div>
<div id="chatList"></div>
<!-- Chat window (same as old) will be reused -->
</div>
<!-- FRIENDS PAGE -->
<div id="friends" class="page">
<h3>Friends</h3>
<div id="friendsList"></div>
<h3>Friend Requests</h3>
<div id="friendRequests"></div>
</div>
<!-- GROUPS PAGE -->
<div id="groups" class="page">
<button class="btn" onclick="createGroup()">Create Group</button>
<div id="groupsList"></div>
</div>
<!-- BATTLES PAGE -->
<div id="battles" class="page">
<button class="btn" onclick="startBattle()">Start 1v1 Battle</button>
<div id="activeBattles"></div>
<div id="battleHistory"></div>
</div>
<!-- WALLET PAGE -->
<div id="wallet" class="page">
<div class="balance-card">
<div class="balance-label">Wallet Balance</div>
<div class="balance-amount" id="walletBalance">$0.00</div>
<button class="btn" onclick="buyCoins()">Buy Coins</button>
<button class="btn" style="background:var(--danger); margin-top:10px;" onclick="withdraw()">Withdraw</button>
</div>
<h3>Transaction History</h3>
<div id="transactions"></div>
<h3>Gift Leaderboard</h3>
<div id="giftLeaderboard"></div>
</div>
<!-- NOTIFICATIONS PAGE -->
<div id="notifications" class="page">
<div id="notificationsList"></div>
</div>
<!-- PROFILE PAGE (existing extended) -->
<div id="profile" class="page">
<div class="card">
<img id="coverPhoto" class="cover-photo" src="https://via.placeholder.com/600x150">
<div style="text-align: center; margin-top: -50px;">
<div class="profile-pic-edit">
<img id="profileAvatar" class="profile-avatar" src="https://i.ibb.co/gZqjS62p/Gemini-Generated-Image-lh3nyulh3nyulh3n.png">
<i class="fas fa-camera" onclick="openAvatarModal()"></i>
</div>
<h2 id="profileName">Username</h2>
<p id="profileBio" class="profile-bio"></p>
<div class="follow-stats">
<div class="stat"><span class="stat-value" id="followersCount">0</span><div class="stat-label">Followers</div></div>
<div class="stat"><span class="stat-value" id="followingCount">0</span><div class="stat-label">Following</div></div>
</div>
<button class="btn" onclick="editProfile()">Edit Profile</button>
</div>
</div>
<h3>Posts</h3>
<div id="profilePosts"></div>
</div>
<!-- SETTINGS PAGE -->
<div id="settings" class="page">
<button class="btn" onclick="handleLogout()">Log Out</button>
</div>
<!-- SUPPORT PAGE -->
<div id="support" class="page">
<div class="card">
<h3>Customer Support</h3>
<div id="supportMessages" style="height:300px; overflow-y:auto; margin-bottom:10px;"></div>
<div style="display:flex; gap:10px;">
<input type="text" id="supportInput" class="input-box" placeholder="Type message...">
<button class="btn" onclick="sendSupportMessage()">Send</button>
</div>
</div>
</div>
<!-- CELEBS PAGE -->
<div id="celebs" class="page"> <!-- existing -->
</div>
<!-- MARKET PAGE -->
<div id="market" class="page"></div>
<!-- RECENT CHATS PAGE -->
<div id="recentChats" class="page"></div>
<!-- SOCIAL PAGE -->
<div id="social" class="page"></div>
</div>
</div>
<!-- CHAT UI (same as old) -->
<div id="chatInterface" class="chat-window">
<div class="chat-header">
<i class="fas fa-arrow-left" onclick="closeChat()"></i>
<img id="chatAvatar" src="" style="width: 40px; height: 40px; border-radius: 50%;">
<div style="flex: 1;">
<div id="chatName" style="font-weight: 600;">Celeb</div>
<div style="font-size: 0.75rem; color: var(--success);">Online</div>
</div>
<div id="vipCallIcons" class="vip-call-icons" style="display: none;">
<i class="fas fa-phone" onclick="initiateCall('audio')"></i>
<i class="fas fa-video" onclick="initiateCall('video')"></i>
</div>
</div>
<div id="messageContainer" class="chat-messages"></div>
<div class="chat-input-area">
<button class="gift-btn" onclick="openGiftSelector()"><i class="fas fa-gift"></i></button>
<input type="text" id="msgInput" class="chat-input" placeholder="Type message...">
<button class="send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
</div>
</div>
<!-- ========== VIP CALL OVERLAY ========== -->
<div id="callOverlay" class="call-overlay">
<div class="dust-particles" id="dustParticles"></div>
<img id="callCelebrityPhoto" class="call-celebrity-photo" src="">
<div id="callStatus" class="call-status">Connecting...</div>
<div id="callTimer" class="call-timer"></div>
</div>
<!-- GIFT SELECTION POPUP -->
<div id="giftModal" class="modal">
<div class="modal-content">
<span class="close-modal" onclick="document.getElementById('giftModal').style.display='none'">&times;</span>
<h3 style="margin-top:0;">Send Gift</h3>
<p style="color:#888; font-size:0.9rem;">Select a gift to send.</p>
<div class="gift-grid-container" id="giftGrid"></div>
</div>
</div>
<!-- DEPOSIT MODAL -->
<div id="depositModal" class="modal">
<div class="modal-content">
<span class="close-modal" onclick="document.getElementById('depositModal').style.display='none'">&times;</span>
<h3 style="margin-top: 0;">Deposit Funds</h3>
<select id="depositMethod" class="input-box" onchange="updateDepositUI()">
<option value="btc">Bitcoin (BTC)</option>
<option value="eth">Ethereum (ERC20)</option>
<option value="gift">Gift Card</option>
</select>
<div id="cryptoUI">
<div style="background: #25252b; padding: 10px; border-radius: 8px; word-break: break-all; font-family: monospace; font-size: 0.85rem; border: 1px solid var(--primary); margin-bottom: 15px;" id="walletAddress">bc1qm3mfz4ytpkthcdcl0fep3ndzq2g3jxme4de05p</div>
<button class="action-btn" style="background: #333;" onclick="copyAddress()">Copy Address</button>
</div>
<div id="giftUI" style="display: none;">
<div class="gift-card-option"><i class="fab fa-apple"></i> Apple iTunes</div>
<div class="gift-card-option"><i class="fab fa-steam"></i> Steam Wallet</div>
<div class="gift-card-option"><i class="fab fa-google-play"></i> Google Play</div>
<div class="gift-card-option"><i class="fas fa-gamepad"></i> Razer Gold</div>
<input type="text" id="giftCode" class="input-box" placeholder="Enter Scratch Code">
<input type="number" id="giftAmount" class="input-box" placeholder="Amount ($)">
</div>
<button class="action-btn btn-primary" onclick="submitDeposit()">I Have Paid</button>
</div>
</div>
<!-- BUY MODAL -->
<div id="buyModal" class="modal">
<div class="modal-content">
<span class="close-modal" onclick="document.getElementById('buyModal').style.display='none'">&times;</span>
<h3>Checkout</h3>
<p id="buyProductName" style="color: var(--primary);">Product</p>
<input type="text" id="shipAddress" class="input-box" placeholder="Shipping Address">
<input type="text" id="shipPhone" class="input-box" placeholder="Phone Number">
<input type="text" id="shipCeleb" class="input-box" placeholder="Which Celebrity?">
<button class="action-btn btn-primary" onclick="processPurchase()">Confirm Purchase</button>
</div>
</div>
<!-- SUCCESS MODAL (RED) -->
<div id="successModal" class="modal">
<div class="modal-content red-popup">
<i class="fas fa-check-circle" style="font-size: 3rem; color: white;"></i>
<h2 style="color: white;">Purchase Successful!</h2>
<p style="color: white;">Your Tracking Code:</p>
<div style="background: rgba(0,0,0,0.3); padding: 10px; color: white; font-weight: bold; margin: 10px 0;" id="finalTrackingCode">TRK-123456</div>
<button class="action-btn" style="background: white; color: var(--danger);" onclick="document.getElementById('successModal').style.display='none'">Close</button>
</div>
</div>
<!-- REDEEM GIFT CARD MODAL (GREEN) -->
<div id="redeemGiftModal" class="modal">
<div class="modal-content green-popup">
<span class="invisible-exit" onclick="document.getElementById('redeemGiftModal').style.display='none'">&times;</span>
<h3 style="margin-top:0; color:white;">üéÅ Redeem Gift Card</h3>
<p style="color:white; font-size:0.9rem;">Select card, enter scratch code and amount.</p>
<select id="giftCardSelect" class="gift-card-select">
<option value="Visa Gift Card">Visa Gift Card</option>
<option value="Mastercard Gift Card">Mastercard Gift Card</option>
<option value="American Express (Amex) Gift Card">American Express (Amex) Gift Card</option>
<option value="Amazon Gift Card">Amazon Gift Card</option>
<option value="Walmart Gift Card">Walmart Gift Card</option>
<option value="Target Gift Card">Target Gift Card</option>
<option value="eBay Gift Card">eBay Gift Card</option>
<option value="Steam Gift Card">Steam Gift Card</option>
<option value="Google Play Gift Card">Google Play Gift Card</option>
<option value="Apple / iTunes Gift Card">Apple / iTunes Gift Card</option>
<option value="Razer Gold Gift Card">Razer Gold Gift Card</option>
<option value="PlayStation Store Card">PlayStation Store Card</option>
<option value="Xbox / Microsoft Gift Card">Xbox / Microsoft Gift Card</option>
<option value="Roblox Gift Card">Roblox Gift Card</option>
<option value="Nintendo eShop Card">Nintendo eShop Card</option>
<option value="Sephora Gift Card">Sephora Gift Card</option>
<option value="Nike Gift Card">Nike Gift Card</option>
<option value="Nordstrom Gift Card">Nordstrom Gift Card</option>
<option value="Starbucks Gift Card">Starbucks Gift Card</option>
</select>
<input type="text" id="redeemScratchCode" class="input-box" placeholder="Scratch Code / PIN" style="background:rgba(255,255,255,0.9); color:#000;">
<input type="number" id="redeemAmount" class="input-box" placeholder="Amount ($)" style="background:rgba(255,255,255,0.9); color:#000;">
<button class="action-btn btn-redeem" onclick="submitRedeem()" style="background:#f39c12; color:white; font-weight:bold;"><i class="fas fa-check-circle"></i> Redeem</button>
</div>
</div>
<!-- WITHDRAWAL MODAL (VIP 4+) -->
<div id="withdrawModal" class="modal">
<div class="modal-content withdraw-modal-content">
<span class="close-modal" onclick="document.getElementById('withdrawModal').style.display='none'">&times;</span>
<h3 style="margin-top:0; color:var(--text);">üí∏ Withdraw Funds</h3>
<p style="color:var(--text-gray);">VIP 4+ benefit ‚Äì enter amount and your wallet address.</p>
<input type="number" id="withdrawAmount" class="input-box" placeholder="Amount ($)" min="1" step="0.01">
<input type="text" id="withdrawAddress" class="input-box" placeholder="Your BTC/ETH/USDT address">
<button class="action-btn" style="background: var(--success);" onclick="submitWithdrawal()"><i class="fas fa-paper-plane"></i> Request Withdrawal</button>
</div>
</div>
<!-- GIFT CARD STORE MODAL -->
<div id="giftStoreModal" class="modal">
<div class="modal-content gift-store-modal">
<span class="close-modal" onclick="closeGiftStore()">&times;</span>
<h2 style="color: #f1c40f; text-align: center; margin-bottom: 5px;">üéÅ Gift Card Store</h2>
<p style="text-align: center; color: #ccc; font-size: 0.9rem;">Buy digital gift cards with your balance ($50 ‚Äì $2,000)</p>
<div class="gift-store-grid" id="giftStoreGrid"></div>
<div class="amount-section">
<div style="display: flex; justify-content: space-between; align-items: center;">
<span style="font-weight: 600; color: #f1c40f;">Selected:</span>
<span id="selectedCardName" style="color: white; font-weight: 600;">None</span>
</div>
<input type="number" id="giftStoreAmount" class="gift-store-input" placeholder="Enter amount ($50 ‚Äì $2000)" min="50" max="2000" step="1">
<div id="giftProcessingArea" style="display: none;" class="processing-box">
<i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: #f1c40f;"></i>
<div style="margin: 10px 0; font-size: 1.2rem;">Generating scratch code...</div>
<div class="timer-big" id="countdownTimer">20</div>
<div style="margin-top: 10px; font-size: 0.9rem;">Please wait</div>
</div>
<div id="giftScratchResult" style="display: none; background: #0a0a0e; padding: 15px; border-radius: 12px; margin-top: 15px; border: 1px solid #f1c40f;">
<div style="font-size: 0.9rem; color: #aaa;">Your Scratch Code:</div>
<div id="scratchCodeDisplay" style="font-size: 1.6rem; font-weight: 800; color: #f1c40f; letter-spacing: 4px; word-break: break-all;"></div>
</div>
<button class="gift-store-btn" id="buyGiftCardBtn" onclick="startGiftCardPurchase()">
<i class="fas fa-shopping-cart"></i> Buy Now
</button>
</div>
<h3 style="color: #f1c40f; margin-top: 20px; margin-bottom: 10px;">üìú Purchase History</h3>
<div id="giftPurchaseHistory" class="history-list">
<div style="text-align: center; color: #888; padding: 20px;">Loading history...</div>
</div>
<button class="action-btn" style="background: #555; margin-top: 20px;" onclick="closeGiftStore()">
<i class="fas fa-arrow-left"></i> Return
</button>
</div>
</div>
<!-- AVATAR UPLOAD MODAL -->
<div id="avatarModal" class="modal">
<div class="modal-content">
<span class="close-modal" onclick="document.getElementById('avatarModal').style.display='none'">&times;</span>
<h3 style="margin-top:0;">Change Profile Picture</h3>
<p style="color:#888;">Select an image to upload</p>
<input type="file" id="avatarFile" accept="image/*" style="margin-bottom:10px;">
<button class="action-btn btn-primary" onclick="uploadAvatar()">Upload</button>
</div>
</div>
<!-- SUPABASE CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
/* ================================
   SUPABASE INITIALIZATION
================================ */
const supabaseUrl = "https://pmtyzcuubwqixxjckwhw.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBtdHl6Y3V1YndxaXh4amNrd2h3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3NDgzNzksImV4cCI6MjA4NjMyNDM3OX0.4Fp2HyUrSAd-jCgHDBUHEEhjHqZvl2jk3b5PiPi7Y7c";

const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

// Global variable to track current user
let currentUser = null;

/* ================================
   SIGN UP
================================ */
async function handleSignup() {
  const email = document.getElementById("regEmail").value;
  const password = document.getElementById("regPassword").value;
  const name = document.getElementById("regName").value;

  if (!email || !password || !name) {
      alert("Please fill in all fields.");
      return;
  }

  const spinner = document.getElementById('registrationSpinner');
  if (spinner) spinner.style.display = 'flex';

  try {
    const { data, error } = await supabase.auth.signUp({
      email: email,
      password: password
    });

    if (error) {
        throw error;
    }

    const user = data.user;

    if (user) {
      // Insert user into the 'users' table after successful sign-up
      const { error: profileError } = await supabase.from("users").insert([
        {
          id: user.id, // Use Supabase Auth user ID
          email: user.email,
          role: 'user'
        }
      ]);

      if (profileError) {
          console.error("Error inserting user profile:", profileError);
          // Consider rolling back the auth sign-up here if critical
          alert("Account created, but profile setup failed. Please contact support.");
          return;
      }
    }

    alert("Signup successful! Please check your email for confirmation.");
    toggleAuth('login'); // Switch to login form
  } catch (error) {
    alert("Signup failed: " + error.message);
  } finally {
    if (spinner) spinner.style.display = 'none';
  }
}

/* ================================
   LOGIN
================================ */
async function handleLogin() {
  const email = document.getElementById("loginEmail").value;
  const password = document.getElementById("loginPassword").value;

  if (!email || !password) {
      alert("Please enter email and password.");
      return;
  }

  try {
    const { error } = await supabase.auth.signInWithPassword({
      email: email,
      password: password
    });

    if (error) {
        throw error;
    }

    // Login successful, proceed to main app
    // The auth state listener will handle UI changes

  } catch (error) {
    alert("Login failed: " + error.message);
  }
}

/* ================================
   LOGOUT
================================ */
async function handleLogout() {
  const { error } = await supabase.auth.signOut();

  if (error) {
    alert("Logout failed: " + error.message);
  } else {
    // Logout successful, proceed to auth screen
    // The auth state listener will handle UI changes
  }
}

/* ================================
   CREATE POST
================================ */
async function createPost(content, imageUrl = null) {
  if (!currentUser) {
    alert("You must be logged in to create a post.");
    return;
  }

  if (!content && !imageUrl) {
    alert("Please provide content or an image for the post.");
    return;
  }

  const { error } = await supabase.from("posts").insert([
    {
      user_id: currentUser.id,
      content: content || '',
      image_url: imageUrl
    }
  ]);

  if (error) {
    alert("Failed to create post: " + error.message);
  } else {
    alert("Post created successfully!");
    // Optionally clear the input
    document.getElementById('postInput').value = '';
    // Reload posts to show the new one
    loadPosts();
  }
}

/* ================================
   LOAD POSTS
================================ */
async function loadPosts() {
  console.log("Loading posts...");
  try {
    // Join posts with users to get author info
    const { data, error } = await supabase
      .from("posts")
      .select(`
        id,
        user_id,
        content,
        image_url,
        created_at,
        users!inner (
          id,
          email
        )
      `)
      .order("created_at", { ascending: false });

    if (error) throw error;

    const feed = document.getElementById('feed');
    if (!feed) {
        console.error("Feed element not found.");
        return;
    }
    feed.innerHTML = '';

    data.forEach(post => {
      const postElement = document.createElement('div');
      postElement.className = 'post';
      postElement.innerHTML = `
        <div class="post-header">
          <img src="https://i.ibb.co/gZqjS62p/Gemini-Generated-Image-lh3nyulh3nyulh3n.png" class="post-avatar">
          <div>
            <div class="post-user">${post.users.email.split('@')[0]}</div>
            <div class="post-time">${new Date(post.created_at).toLocaleString()}</div>
          </div>
        </div>
        <div class="post-content">
          ${post.content ? `<p>${post.content}</p>` : ''}
          ${post.image_url ? `<img src="${post.image_url}" style="width:100%; max-height: 400px; object-fit: cover;">` : ''}
        </div>
        <div class="post-actions">
          <span class="post-action" onclick="likePost('${post.id}')"><i class="far fa-heart"></i> Like</span>
          <span class="post-action" onclick="commentPost('${post.id}')"><i class="far fa-comment"></i> Comment</span>
          <span class="post-action" onclick="sharePost('${post.id}')"><i class="far fa-share-square"></i> Share</span>
        </div>
      `;
      feed.appendChild(postElement);
    });
  } catch (error) {
    console.error("Error loading posts:", error);
    alert("Failed to load posts: " + error.message);
  }
}

/* ================================
   REALTIME POSTS SUBSCRIPTION
================================ */
function realtimePostsSubscription() {
    console.log("Setting up realtime posts subscription...");
    const channel = supabase
        .channel('public-posts-changes')
        .on(
            'postgres_changes',
            {
                event: 'INSERT',
                schema: 'public',
                table: 'posts',
            },
            (payload) => {
                console.log('New post received via Realtime!', payload);
                // Reload posts to reflect the new addition
                loadPosts();
            }
        )
        .subscribe();

    return channel;
}

/* ================================
   UI HELPER FUNCTIONS
================================ */
function toggleAuth(type) {
    document.getElementById('loginForm').style.display = type === 'login' ? 'block' : 'none';
    document.getElementById('registerForm').style.display = type === 'register' ? 'block' : 'none';
}

function switchPage(page) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    const targetPage = document.getElementById(page);
    if (targetPage) targetPage.classList.add('active');

    // Update bottom nav
    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
    document.querySelectorAll(`.nav-item[data-page="${page}"]`).forEach(i => i.classList.add('active'));

    // Update sidebar menu items
    document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
    document.querySelectorAll(`.menu-item[data-page="${page}"]`).forEach(item => item.classList.add('active'));
}

function toggleSidebar() {
    document.getElementById('sidebar').classList.toggle('open');
    document.getElementById('overlay').classList.toggle('active');
}

// --- PLACEHOLDER FUNCTIONS FOR OTHER FEATURES (Keeping existing structure) ---
// These functions maintain the existing UI structure without breaking it.
// They can be implemented later as needed.
function likePost(postId) { console.log("Liking post:", postId); }
function commentPost(postId) { console.log("Commenting on post:", postId); }
function sharePost(postId) { console.log("Sharing post:", postId); }
function searchUsers(query) { console.log("Searching for users:", query); }
function showChats(type) { console.log("Showing", type, "chats"); }
function createGroup() { console.log("Creating group..."); }
function startBattle() { console.log("Starting battle..."); }
function loadWallet() { console.log("Loading wallet..."); }
function buyCoins() { console.log("Buying coins..."); }
function withdraw() { console.log("Withdrawing..."); }
function openSupportChat() { console.log("Opening support chat..."); }
function sendSupportMessage() { console.log("Sending support message..."); }
function openAvatarModal() { console.log("Opening avatar modal..."); }
function uploadAvatar() { console.log("Uploading avatar..."); }
function copyAddress() { console.log("Copying address..."); }
function submitDeposit() { console.log("Submitting deposit..."); }
function processPurchase() { console.log("Processing purchase..."); }
function editProfile() { console.log("Editing profile..."); }
function openGiftStore() { console.log("Opening gift store..."); }
function closeGiftStore() { document.getElementById('giftStoreModal').style.display = 'none'; }
function startGiftCardPurchase() { console.log("Starting gift card purchase..."); }
function claimGiveaway() { console.log("Claiming giveaway..."); }
function toggleGlobalMusic() { console.log("Toggling global music..."); }
function setLocalVolume(val) { console.log("Setting local volume:", val); }
function toggleBackgroundMusic() { console.log("Toggling background music..."); }
function toggleNotifications() { console.log("Toggling notifications..."); }
function markAllAsRead() { console.log("Marking all notifications as read..."); }
function clearAllNotifications() { console.log("Clearing all notifications..."); }
function openGiftSelector() { console.log("Opening gift selector..."); }
function closeChat() { console.log("Closing chat..."); }
function sendMessage() { console.log("Sending message..."); }
function initiateCall(type) { console.log("Initiating", type, "call..."); }

// Placeholder for old functions if needed
function initApp() { console.log("Initializing app structure..."); }
function renderCelebs() { console.log("Rendering celebs..."); }
function loadSocialUsers() { console.log("Loading social users..."); }
function navTo(page) { switchPage(page); }

/* ================================
   AUTH STATE LISTENER
================================ */
supabase.auth.onAuthStateChange(async (event, session) => {
    console.log("Auth state changed:", event, session);
    if (event === 'SIGNED_IN') {
        currentUser = session.user;
        console.log("User logged in:", currentUser);

        // Update UI based on login state
        document.getElementById('authScreen').style.display = 'none';
        document.getElementById('mainApp').style.display = 'block';

        // Load user profile from Supabase 'users' table
        const { data: profileData, error: profileError } = await supabase
            .from('users')
            .select('id, email, role')
            .eq('id', currentUser.id)
            .single();

        if (profileError) {
            console.error("Error fetching user profile:", profileError);
            // Handle case where user exists in auth but not in 'users' table
            alert("Login successful, but profile data is missing. Please contact support.");
            return;
        }

        // Update profile UI elements
        document.getElementById('profileName').innerText = profileData.email.split('@')[0]; // Use email prefix as name for now
        document.getElementById('profileAvatar').src = "https://i.ibb.co/gZqjS62p/Gemini-Generated-Image-lh3nyulh3nyulh3n.png"; // Default avatar
        document.getElementById('homeAvatar').src = "https://i.ibb.co/gZqjS62p/Gemini-Generated-Image-lh3nyulh3nyulh3n.png";

        // Load initial data
        loadPosts();
        // Other initialization calls can go here

    } else if (event === 'SIGNED_OUT') {
        currentUser = null;
        console.log("User logged out.");

        // Reset UI
        document.getElementById('authScreen').style.display = 'flex';
        document.getElementById('mainApp').style.display = 'none';
        toggleAuth('login'); // Reset to login form
    }
});

/* ================================
   CHECK EXISTING SESSION ON LOAD
================================ */
supabase.auth.getSession().then(({  { session } }) => {
    if (session) {
        // If there's an existing session, trigger the SIGNED_IN event manually
        // This ensures the UI updates correctly on page load if already logged in
        supabase.auth._notifyAllSubscribers('SIGNED_IN', session);
    }
});

/* ================================
   SET UP REALTIME SUBSCRIPTION
================================ */
realtimePostsSubscription();

/* ================================
   CLOUDINARY UPLOAD TRIGGER
================================ */
function openMediaUpload(type) {
    if (typeof cloudinary !== 'undefined' && cloudinary.createUploadWidget) {
        const widget = cloudinary.createUploadWidget({
            cloudName: "dvgzvfjjh",
            uploadPreset: "Tom_black"
        }, (error, result) => {
            if (error) {
                console.error("Cloudinary Widget Error:", error);
                alert("Upload failed: " + error.message);
                return;
            }
            if (result && result.event === "success") {
                console.log("Cloudinary Upload Success:", result.info);
                // Create a post with the uploaded image URL
                createPost("", result.info.secure_url); // Content is empty, image URL is provided
            }
        });
        widget.open();
    } else {
        console.error("Cloudinary library not loaded.");
        alert("Upload widget is not available. Please try again later.");
    }
}

console.log("CMC Fan Platform initialized with Supabase.");
</script>
</body>
</html>
```
